{
  parserClass="com.bamuel.spllang.parser.SPLParser"

  extends="com.intellij.extapi.psi.ASTWrapperPsiElement"

  psiClassPrefix="SPL"
  psiImplClassSuffix="Impl"
  psiPackage="com.bamuel.spllang.psi"
  psiImplPackage="com.bamuel.spllang.psi.impl"

  elementTypeHolderClass="com.bamuel.spllang.psi.SPLTypes"
  elementTypeClass="com.bamuel.spllang.psi.SPLElementType"
  tokenTypeClass="com.bamuel.spllang.psi.SPLTokenType"
}

splFile ::= item_*

item_ ::=  declaration_ | statement_ | preprocessor_ | function_ | element_
    declaration_ ::= api_ | field_ | local_ | menu_ | mode_ | object_ | parameters_ | procedure_ | returning_ | screen_ | comments_

    statement_ ::= abort_ | accept_ | acknowledge_ | audit_ | back-to-detail_ | beginwork_ | box_ | break_ | call_ | callurl_ | checkbox_ | clear_ | close_ | command_ | commitwork_ | confirm_ | continue_
                 | continueentry_ | delete_ | disablealltriggers_ | display_ | do_ | dropdown_ | exit_ | extract_ | field-group_ | for_ | get_ | if_ | initialise_ | insert_ | link_ | lock-method_ | message_ | messagebox_
                 | need_ | open_ | option_ | page_ | pause_ | pop_ | position_ | print_ | push_ | query_ | radio-button_ | re-enter_ | refresh_ | repeat_ | report_ | reportfinish_ | reportsection_ | reportsectionfinish_
                 | re-select_ | restore_ | rollbackwork_ | save_ | screengroup_ | screensection_ | select_ | serial_ | set_ | set2_ | set-date-validation_ | skip_ | sql-delete_ | sql-update_ | statement-group_ | stringstatement_ | switch_
                 | transaction_ | unlock_ | update_ | version-number_ | web-client-local-agent_ | while_ | comments_

    preprocessor_ ::= preprocessors_ //Pre-processor commands summary //todo: split into individual preprocessor commands

    function_ ::= arithmeticfunction_  | datetimefunction_ | filehandlingfunction_ | environmentfunction_ | stringfunction_

        arithmeticfunction_ ::= aand_ | abs_ | anot_ | aor_ | cos_ | fraction_ | integer_ | lshift_ | max-value_ | max-presentation-value_
        | min-value_ | power-of_ | random_ | rshift_ | sign-of_ | sin_ | smallest-increment_ | square-root_ | sum_ | sum-array_ | tan_

        datetimefunction_ ::= add-month_ | client-date-time-string_ | date-from-date-time_ | date-time_ | date-to-julian_ | day_ | day-name_
        | days-in-month_ | dow_ | gmt_ | hour_ | julian_ | julian-to-date_ | leap-year_ | minute_ | month_ | month-name_ | second_
        | systime_ | time-from-date-time_ | time-zone_ | tod_ | today_ | year_

        filehandlingfunction_ ::= cd_ | cd-without-close-all_ | client-file-browse_ | dir_ | file-exists_ | file-name_ | file-owner_ | file-size_
        | file-status_ | file-version_ | finish-dir-search_ | is-a-dir_ | local-cd_ | local-cd-without-close-all_ | local-dir_ | mkdir_
        | modification-time_ | next-dir-entry_ | rmdir_ | start-dir-search_

        environmentfunction_ ::= activepid_ | apiapplication-name_ | batched_ | can-dee_ | check-auth_ | colour-picker_
        | create-db-schema_ | create-db-user_ | currency-sign_ | database-type_ | db-command_ | db-table-name_ | dde-error-status_
        | dde-execute_ | dde-initiate_ | dde-poke_ | dde-request_ | dde-terminate_ | delete-registry-value_ | enable-status-bar_
        | enable-system-menu_ | enable-tool-bar_ | error-description_ | escape_ | exit-status_ | find-parameter_ | getenv_ | get-field-value_
        | get-field-value-numeric_ | get-function-code_ | get-module-code_ | get-param_ | get-registry-enum-key_ | get-registry-enum-value_
        | get-registry-value_ | get-system-metrics_ | gid_ | grant-db-schema_ | hide-dockable-windows_ | idx_ | if-then-else_ | io-count_
        | line-no_ | local-no_ | login-id_ | mail-add-line_ | mail-attach_ | mail-cancel_ | mail-from-name_ | mail-reply-to_ | mail-send_
        | mail-start_ | max-screen-columns_ | max-screen-rows_ | message-status_ | mode-name_ | mouse-column_ | mouse-row_ | node-name_
        | occurrence_ | operating-system_ | page-no_ | param-cnt_ | pid_ | pronto-release_ | prouser-flags_ | refresh-quick-links_
        | report-is-xml_ | review-row_ | revoke-db-schema_ | rgb-to-colour_ | screen-mode_ | search_ | search-mode_ | set-app-user_
        | set-data-area-name_ | set-background-image_ | set-background-url_ | set-environment_ | set-function-code_ | set-help-context_
        | set-keyboard-focus_ | set-module-code_ | set-registry-value_ | set-web-window_ | sleep_ | spool-file-name_ | time-elapsed_
        | transaction-active_ | tty_ | uid_ | user-group_ | valid-activation-key_ | wait-for-input_

        stringfunction_ ::= ascii-char_ | ascii-num_ | base64toblob_| blobappend_ | blobappendbase64_ | blobsection_ | blobtobase64_
        | concat_ |  formatpicture_ | freeblob_ | fstr_ | leftjustify_ | lowercase_ | ltrim_ | maxalphavalue_ | num_ | paramtext_ | pattern_
        | readblobfromfile_ | reserved_ | rightjustify_ | rtrim_ | sizeof_ | sqlsubstring_ | strconcat_ | str_ | strlen_ | substring_
        | substringutf8_ | uppercase_ | validnumber_ | writeblobtofile_ | zstr_

//Statement rules
abort_ ::= ABORT string_ (PIC ("is")? picture_)? NOLOG?
accept_ ::= ACCEPT IDENTIFIER rowcol_ col_? accepttitle_? NOTITLE? MULTILINE? rows_? columns_? acceptpicture_? BLANK_WHEN_ZERO? BLANK_DECIMALS_WHEN_ZERO? OPTIONAL? acceptdefault_? acceptallow_? acceptdisallow_? JUSTIFY? AUTO_RETURN? timeout_? acceptedits_? acceptfill_? acceptlookup_? accpetcase_? acceptjustify_? accepthelp_? BOLD? DIM? FLASHING? INVERSE? ITALIC? UNDERLINED? FOREGROUND? BACKGROUND? BLANK? acceptonerror_? acceptfunctionkey_? accepttag_? accepthelpcontext_? accepthelpscreen_? acceptwhen_? SHOW_VALUE? NO_CLEAR? SUPPRESS? CONDITIONAL_SUPPRESS? READ_ONLY? FIXED_WIDTH_FONT? colour_? beforeaccept_? acceptvalidation_? USE_VALIDATE_TRIGGER? acceptproceduralstatement_ scale_? NO_WARNING? acceptonchange_?
accepttitle_ ::= (TITLE|COLUMNTITLE) ("is")? string_ rowcol_?
rows_ ::= ROWS number_
columns_ ::= COLUMNS number_
acceptpicture_ ::= PIC ("is")? picture_
acceptdefault_ ::= DEFAULT ("is")? string_
acceptallow_ ::= ALLOW string_ ("to" string_)*
acceptdisallow_ ::= DISALLOW string_ ("to" string_)*
timeout_ ::= TIMEOUT ("is")? number_
acceptedits_ ::= EDIT ("is"|"are")? (string_)*
acceptfill_ ::= FILL ("with")? ("leading"|"trailing")? string_
acceptlookup_ ::= LOOKUP ("not")? ("in")? string_ ("on index" string_)? ("key" ("is")? string_*)?
accpetcase_ ::= LOWERCASE | UPPERCASE
acceptjustify_ ::= LEFT | CENTRE | RIGHT | CENTRE_COORD | RIGHT_COORD
accepthelp_ ::= HELP ("is")? string_
acceptonerror_ ::= ON ERROR statement_* END_ON
acceptfunctionkey_ ::= ON FUNCTION_KEY statement_* END_ON
accepttag_ ::= TAG ("is")? NUMBER
accepthelpcontext_ ::= HELP_CONTEXT ("is")? string_*
accepthelpscreen_ ::= HELP_SCREEN ("primary") IDENTIFIER rowcol_ (OCCURS number_)? SHOWING IDENTIFIER STRING (COMMA IDENTIFIER STRING)* (USING IDENTIFIER)
acceptwhen_ ::= WHEN condition_ //todo: condition
beforeaccept_ ::= BEFORE_ACCEPT statement_* END_BEFORE_ACCEPT
acceptvalidation_ ::= VALIDATIONS statement_* END_VALIDATIONS
acceptproceduralstatement_ ::= statement_*
scale_ ::= SCALE ("is")? number_
acceptonchange_ ::= ON CHANGE statement_* END_ON
acknowledge_ ::= ACKNOWLEDGE string_ (prompt_)?
audit_ ::= AUDIT ("ON"|"OFF")? (IDENTIFIER)*
back-to-detail_ ::= BACK_TO_DETAIL
beginwork_ ::= BEGIN_WORK (ON string_ (COMMA string_)*)? (LEAVING string_ (COMMA string_)*)? FREE_LOCKS? (ON ERROR number_* statement_* END_ON)?
box_ ::= BOX (rowcol_ "to" rowcol_)? DOUBLE? NO_CROSS? (TITLE ("is")? string_)? SUNKEN? colour_? ABSOLUTE_COORDINATES?
break_ ::= BREAK
call_ ::= CALL string_ parameters_? max_parameters_? returning_? home_? BATCH? LEAVE_FILES_OPEN? EXTERNAL? backgroundnowait_? (ON ERROR statement_* END_ON)?
max_parameters_ ::= MAX_PARAMETERS ("are")? number_
home_ ::= HOME ("is")? string_
backgroundnowait_ ::= BACKGROUND | BACKGROUNDNOWAITWAIT
callurl_ ::= CALL_URL string_ httpheaders_? httpbody_? httpmethod_? httpproxy_? httpauthany_? timeout_? cacertificate_? sslcertificate_? sslkey_? sslkeypassword_? allowredirection_? sftpcommand_? sftppostcommand_? sftpcreatedirs_? urluser_? urlloginoptions_? callreturning_? (ON ERROR number_? statement_* END_ON)?
httpheaders_ ::= HTTP_HEADERS ("are")? string_|"file" ("is")? string_?
httpbody_ ::= HTTP_BODY ("is")? string_|"file" ("is")? string_?
httpmethod_ ::= HTTP_METHOD ("is")? string_ //todo: http methods
httpproxy_ ::= HTTP_PROXY ("is")? string_
httpauthany_ ::= HTTP_AUTH_ANY
cacertificate_ ::= CA_CERTIFICATE ("is")? string_
sslcertificate_ ::= SSL_CERTIFICATE ("is")? string_
sslkey_ ::= SSL_KEY ("is")? string_ (SSL_KEY_PASSWORD ("is")? string_)?
allowredirection_ ::= ALLOW_REDIRECTION
sftpcommand_ ::= SFTP_COMMAND ("is")? string_
sftppostcommand_ ::= SFTP_POST_COMMAND ("is")? string_
sftpcreatedirs_ ::= SFTP_CREATE_DIRS
urluser_ ::= URL_USER ("is")? string_ (string_)?
urlloginoptions_ ::= URL_LOGIN_OPTIONS ("is")? string_
callreturning_ ::= RETURNING (HTTP_HEADERS ("in")? string_|"file" ("is")? string_?)? (HTTP_BODY ("is") string_|"file" ("is")? string_?)?
checkbox_ ::= CHECK_BOX string_ rowcol_ (VALUES string_ string_)? (TITLE string_)? colour_? RIGHT_COORDINATE? (DEFAULT ("is")? ("TRUE"|"FALSE"))? READ_ONLY? (WHEN condition_)? (BEFORE_CHECK_BOX statement_* END_BEFORE_CHECK_BOX)? (VALIDATIONS statement_* END_VALIDATIONS)? (ON CHANGE item_* END_ON)? CHECK_BOX_END?
clear_ ::= CLEAR clearoptions_?
clearoptions_ ::= (ROWS number_ ("to") number_) | (rowcol_ ("to") rowcol_) | (DATA) | (DATA|PROMPT rowcol_ "to" rowcol_) | ABSOLUTE_COORDINATES
close_ ::= (CLOSE (string_ ("and remove")? (ON ERROR statement_* END_ON)?)) | (CLOSE "ALL" ("LOCAL"|"RECONNECT")?)
command_ ::= COMMAND parameters_? home_? NO_MESSAGE? NO_REFRESH? NO_XTERM? max_parameters_? BATCH? (BACKGROUND|BACKGROUNDNOWAITWAIT)? EXTERNAL? (ON ERROR statement_* END_ON)? 
commitwork_ ::= COMMIT_WORK (ON ERROR statement_* END_ON)?
confirm_ ::= CONFIRM rowcol_? (AUTO? (WHEN condition_)?)? prompt_? NO_PROMPT? (DEFAULT ("is")? ("yes"|"no"))? (NO_WINDOW|WINDOW)? (BEFORE statement_*)? (CONFIRMED statement_*)? (NOT_CONFIRMED statement_*)? (AFTER statement_*)? CONFIRM_END
continue_ ::= CONTINUE
continueentry_ ::= CONTINUE_ENTRY
delete_ ::= DELETE string_ NO_WARNING? (ON ERROR statement_* END_ON)?
disablealltriggers_ ::= DISABLE_ALL_TRIGGERS
display_ ::= DISPLAY displayoptions_
displayoptions_ ::= displayoption1_ | displayoption2_
displayoption1_ ::= string_ rowcol_ (COL number_)? (PIC picture_)? (TITLE string_)? MULTILINE? (ROWS number_)? (COLUMNS number_)? BLANK_WHEN_ZERO? BLANK_DECIMALS_WHEN_ZERO? BOLD? DIM? FLASHING? INVERSE? ITALIC? UNDERLINED? BELL? FOREGROUND? BACKGROUND? DATA? PROMPT? colour_? scale_? FIXED_WIDTH_FONT? acceptjustify_? (HELP_IS string_)?
displayoption2_ ::= BITMAP string_ rowcol_ ("to" rowcol_)? BACKGROUNDNOWAITWAIT
do_ ::= DO string_ (SCREEN_MODE string_)? SAME? ONCE? SUB_SCREEN? (INITIAL_MODE ("is")? string_)? parameters_? returning_? (NEXT string_)? BACKGROUNDNOWAITWAIT? NO_SECTION?
dropdown_ ::= DROP_DOWN DYNAMIC? OPTIONAL? EDIT? (WIDTH ("is")? number_)? concat_title_? DROP_DOWN_END
concat_title_ ::= CONCAT_TITLE (dropdownvalues_? | selectclauses_?)
dropdownvalues_ ::= (string_ TITLE string_)* | (ICON "is"? string_)* | (WHEN condition_ SHOW_VALUE?)
exit_ ::= EXIT number_? //todo: any number between -1 and 255
extract_ ::= EXTRACT ALL? ((NEXT|PREVIOUS) (SCREEN_SAME_DIFFERENT (IDENTIFIER fieldclauses_)*)?)? LOCK? (ON INDEX string_)? (KEY ("is")? string_*)? (WHERE condition_)? (FINISH WHEN condition_)? (ON ERROR statement_* END_ON)? (DETAIL statement_*)? (BEFORE (IDENTIFIER fieldclauses_)* statement_*)? (AFTER (IDENTIFIER fieldclauses_)* statement_*)? EXTRACT_END 
field-group_ ::= FIELD_GROUP (WHEN condition_)? (TITLE ("is")? string_)? VERTICAL? WRAP? (TAG ("is")? number_)? statement_* FIELD_GROUP_END
for_ ::= FOR string_ EQUALS expression_ DOWN? TO expression_ (STEP expression_)? DETAIL? statement_* FOR_END 
get_ ::= GET ((IDENTIFIER fieldclauses_)* FROM)? string_ (NEXT|PREVIOUS)? (SCREEN_SAME_DIFFERENT (IDENTIFIER fieldclauses_)*)? (FROM | FIRST | LAST | CURRENT | LOOKUP)? (LOCK)? (ON INDEX string_)? (KEY ("is")? string_*)? (ON ERROR statement_* END_ON)?
if_ ::= IF expression_ THEN? statement_* (ELSEIF expression_ statement_*)* (ELSE statement_*)? ENDIF
initialise_ ::= INITIALISE string_ (LEAVING string_ (COMMA string_)*)?
insert_ ::= INSERT string_ LOCK? (ON ERROR statement_* END_ON)?
link_ ::= LINK string_ NO_MAIN?
lock-method_ ::= LOCK_METHOD ("is")? (BACKGROUNDNOWAITWAIT|WAIT_WITH_TIMEOUT)?
message_ ::= MESSAGE (string_)* (NOBELL)?
messagebox_ ::= MESSAGEBOX string_ messsageboxtitle_? messageboxbuttons_? messageboxdefault_? messageboxicon_? messageboxtag_? messageboxhelpcontext_? messageboxoptional_? messageboxbell_?
messsageboxtitle_ ::= TITLE ("is")? string_
messageboxbuttons_ ::= MESSAGEBOX_BUTTONS MESSAGEBOX_BUTTONS_VALUES
messageboxdefault_ ::= DEFAULT ("is")? MESSAGEBOX_BUTTONS_VALUES
messageboxicon_ ::= ICON ("is")? MESSAGEBOX_ICON_VALUES
messageboxtag_ ::= TAG ("is")? NUMBER
messageboxhelpcontext_ ::= HELP_CONTEXT string_
messageboxoptional_ ::= OPTIONAL
messageboxbell_ ::= BELL
need_ ::= NEED string_ ("lines")? (ON string_)?
open_ ::= OPEN string_ (FILE ("is")? string_)? LOCK? CREATE? TRUNCATE? PERMANENTTEMPORARY? PRIVATE? NO_TRIGGERS? LOCAL? READ_ONLY? INDEX_ON_CLOSE? (ON ERROR statement_* END_ON)? 
option_ ::= OPTION menuoption_ (DETAIL? statement_*)? OPTION_END
//todo: buttonstyle values
menuoption_ ::= string_ rowcol_ ("to" rowcol_)? (ROWS number_)? (COLUMNS number_)? (SECURITY string_? ("is")? number_)? (WHEN condition_)? help_? log_? scale_? colour_? BOLD? ITALIC? UNDERLINED? (BITMAP ("is")? string_)? (BITMAP_PUSHED ("is")? string_)? (BITMAP_FOCUS ("is")? string_)? (BITMAP_HOVER ("is")? string_)? (BITMAP_GREYED ("is")? string_)? NO_ASPECT_RATIO? modeicon_? (BUTTON_STYLE ("is")? string_)? (DEFAULT_BUTTON ("is")? string_)? (TEXT_POSITION ("is")? string_)? (HOTKEY ("is")? string_)? HIDDEN? ABSOLUTE_COORDINATES? NO_THEME?
log_ ::= LOG string_?
page_ ::= PAGE NO_HEADER? NO_FOOTER? (ON string_)?
pause_ ::= PAUSE
pop_ ::= POP (string_ (LEAVING string_ (COMMA string_)*)? (LEAVING ALL)? )|((string_ (COMMA string_)*) FROM string_)
position_ ::= POSITION (BEFORE|AFTER)? string_ (ON INDEX string_)? (KEY ("is")? string_*)? (FIRST|LAST)? NO_WARNING?
print_ ::= PRINT string_ (("in") COLUMN number_)? rowcol_? (PIC ("is")? picture_)? BLANK_WHEN_ZERO? BLANK_DECIMALS_WHEN_ZERO? BOLD? UNDERLINED? ITALIC? (SUBSCRIPT|SUPERSCRIPT)? (FONT number_)? (STATIC)? colour_? scale_? (LEFT|RIGHT|CENTRE)? (SECTION ("is")? string_)? accepttag_? expression_? NO_NEWLINE? (ON string_)?
push_ ::= PUSH string_
query_ ::= QUERY string_ parameters_? home_? BATCH? NO_PAUSE? SPOOL? max_parameters_? (ON ERROR statement_* END_ON)? 
radio-button_ ::= RADIO_BUTTON string_ (rowcol_ boolean_ TITLE string_ colour_?)* (BUTTON_WHEN expression_)? (RIGHT_COORDINATE)? (DEFAULT ("is")? expression_)? (WHEN expression_)? READ_ONLY? (BEFORE_RADIO_BUTTON statement_* END_BEFORE_RADIO_BUTTON)? (VALIDATIONS statement_* END_VALIDATIONS)? (ON CHANGE item_* END_ON)? RADIO_BUTTON_END
re-enter_ ::= RE_ENTER (string_)? (OPTIONAL|AUTO)?
refresh_ ::= REFRESH (DATA|WHENS|PROMPTS|REVIEW|TITLE|string_)
repeat_ ::= REPEAT statement_* UNTIL expression_ statement_* REPEAT_END
report_ ::= REPORT string_ (FILE ("is")? string_)? (DIRECT ("to")? string_)? (NAME ("is")? string_)? (HEADER ("is")? string_)? (FOOTER ("is")? string_)? (WIDTH ("is")? expression_)? (DEPTH ("is")? expression_)? (LENGTH ("is")? expression_)? (MARGIN ("is")? expression_)? (DEFAULT FONT ("is")? expression_)? FULL_PAGE? (FORM TYPE ("is")? string_) NO_XML? SPOOL_ONLY? FULL_XML? NO_MESSAGE? (ON ERROR statement_* END_ON)? 
reportfinish_ ::= REPORT FINISHED (ON string_)?
reportsection_ ::= REPORT SECTION ("is")? string_? (HIDDEN|CAN_HIDE)? colour_? (STYLE_CLASS ("is")? string_)? (ON string_)?
reportsectionfinish_ ::= REPORT SECTION FINISHED (ON string_)?
re-select_ ::= RE_SELECT
restore_ ::= RESTORE (string_ (LEAVING string_ (COMMA string_)*)? (LEAVING ALL)? )|((string_ (COMMA string_)*) FROM string_)
rollbackwork_ ::= ROLLBACK_WORK (ON ERROR statement_* END_ON)? 
save_ ::= SAVE string_
screengroup_ ::= SCREEN_GROUP (WHEN condition_)? (TITLE ("is")? string_)? (NEXT ROW)? HORIZONTAL? (WIDTH ("is")? number_)? (GROUP_STYLE ("is")? number_)? (TAG ("is")? number_)? statement_* SCREEN_GROUP_END
screensection_ ::= SCREEN_SECTION (WHEN condition_)? (TITLE ("is")? string_)? help_? (SECTION_WHEN condition_)? ALWAYS_SHOW? (HIDDEN|HIDE)? do_ SCREEN_SECTION_END
select_ ::= selectclauses_ (ON ERROR statement_* END_ON)? (BEFORE statement_* END_BEFORE)? (AFTER statement_* END_AFTER)? SELECT_END
selectclauses_ ::= SELECT DISTINCT? selectlist_* FROM string_ (WHERE condition_)? (DATABASE_SQL|LOCAL_SQL)? (ORDER "by" (string_ DESC?)*)? (GROUP "by" string_*)? (HAVING condition_)? ((FOR UPDATE) | FOR_UPDATE)?
selectlist_ ::=  "*" | (IDENTIFIER (COMMA IDENTIFIER)*)
serial_ ::= SERIAL string_ string_ (ON INDEX string_)? (KEY ("is")? expression_) (ON ERROR statement_* END_ON)? 
set_ ::= SET objectarraystring_* assignmentoperator_ (expression_|objectarraystring_*) (NO_WARNING)?
objectarraystring_ ::= string_ | "[" | "]" | "*" | "."
set2_ ::= SET (PAGE_NO|(DEFAULT FONT)) assignmentoperator_ expression_ (ON string_)?
assignmentoperator_ ::= "=" | "+=" | "-=" | "*=" | "/=" | "%="
set-date-validation_ ::= SET_DATE_VALIDATION accepthelpcontext_?
skip_ ::= SKIP ((expression_? ("lines")?)|("to" ("line")? expression_)) (ON string_)?
sql-delete_ ::= SQL_DELETE ALL? string_ (WHERE condition_)? (ON ERROR statement_* END_ON)? 
sql-update_ ::= SQL_UPDATE ALL? string_ SET (IDENTIFIER "=" expression_)* (WHERE condition_)? (ON ERROR statement_* END_ON)? //todo: expression with subquery & procedural-statements
statement-group_ ::= STATEMENT_GROUP item_* STATEMENT_GROUP_END
stringstatement_ ::= stringstatement1_ | stringstatement2_ | stringstatement3_
stringstatement1_ ::= STRINGSTATMENT string_ (INSERTING|REPLACING) string_ "at" string_
stringstatement2_ ::= STRINGSTATMENT string_ DELETING string_ "to" string_
stringstatement3_ ::= STRINGSTATMENT string_ APPENDING string_
switch_ ::= SWITCH ON string_ (CASE string_ statement_*)* (ELSE statement_*)? SWITCH_END
transaction_ ::= TRANSACTION (transactionbegin_ | transactioncommit_ | transactionrollback_)
transactionbegin_ ::= BEGIN (ON string_ (COMMA STRING)*)? (LEAVING string_ (COMMA STRING)*)? FREE_LOCKS? (ON ERROR statement_* END_ON)? 
transactioncommit_ ::= COMMIT (ON ERROR statement_* END_ON)? 
transactionrollback_ ::= ROLLBACK (ON ERROR statement_* END_ON)? 
unlock_ ::= UNLOCK (string_|ALL) LOCAL?
update_ ::= UPDATE string_ NO_WARNING? LOCK? (ON ERROR statement_* END_ON)? 
version-number_ ::= VERSION_NUMBER ("is")? number_
web-client-local-agent_ ::= WEB_CLIENT_LOCAL_AGENT ("ON"| "OFF")
while_ ::= WHILE expression_ DETAIL? statement_* WHILE_END


//Arithmetic functions
aand_ ::= AAND LPAREN number_ COMMA number_ RPAREN
abs_ ::= ABS LPAREN number_ RPAREN
anot_ ::= ANOT LPAREN number_ RPAREN
aor_ ::= AOR LPAREN number_ COMMA number_ RPAREN
cos_ ::= COS LPAREN number_ RPAREN
fraction_ ::= FRACTION LPAREN number_ RPAREN
integer_ ::= INTEGER LPAREN number_ RPAREN
lshift_ ::= LSHIFT LPAREN number_ COMMA number_ RPAREN
max-value_ ::= MAX_VALUE LPAREN number_ RPAREN
max-presentation-value_ ::= MAX_PRESENTATION_VALUE LPAREN number_ RPAREN
min-value_ ::= MIN_VALUE LPAREN number_ RPAREN
power-of_ ::= POWER_OF LPAREN number_ COMMA number_ RPAREN
random_ ::= RANDOM LPAREN number_ RPAREN
rshift_ ::= RSHIFT LPAREN number_ COMMA number_ RPAREN
sign-of_ ::= SIGN_OF LPAREN number_ RPAREN
sin_ ::= SIN LPAREN number_ RPAREN
smallest-increment_ ::= SMALLEST_INCREMENT LPAREN number_ RPAREN
square-root_ ::= SQUARE_ROOT LPAREN number_ RPAREN
sum_ ::= SUM LPAREN number_ RPAREN
sum-array_ ::= SUM_ARRAY LPAREN number_ COMMA number_ COMMA number_ RPAREN
tan_ ::= TAN LPAREN number_ RPAREN

//Date and time functions
add-month_ ::= ADD_MONTH LPAREN datestring_ COMMA number_ COMMA number_ RPAREN
client-date-time-string_ ::= CLIENT_DATE_TIME_STRING LPAREN RPAREN
date-from-date-time_ ::= DATE_FROM_DATE_TIME LPAREN datestring_ COMMA boolean_ RPAREN
date-time_ ::= DATE_TIME LPAREN datestring_ COMMA datestring_ COMMA boolean_ RPAREN
date-to-julian_ ::= DATE_TO_JULIAN LPAREN string_ RPAREN
day_ ::= DAY LPAREN datestring_ RPAREN
day-name_ ::= DAY_NAME LPAREN datestring_ RPAREN
days-in-month_ ::= DAYS_IN_MONTH LPAREN number_ COMMA number_ RPAREN
dow_ ::= DOW LPAREN datestring_ RPAREN
gmt_ ::= GMT LPAREN RPAREN
hour_ ::= HOUR LPAREN datestring_ RPAREN //todo: stricter TIME
julian_ ::= JULIAN LPAREN number_ COMMA number_ COMMA number_ RPAREN
julian-to-date_ ::= JULIAN_TO_DATE LPAREN datestring_ RPAREN
leap-year_ ::= LEAP_YEAR LPAREN number_ RPAREN
minute_ ::= MINUTE LPAREN datestring_ RPAREN //todo: stricter TIME
month_ ::= MONTH LPAREN datestring_ RPAREN
month-name_ ::= MONTH_NAME LPAREN datestring_ RPAREN
second_ ::= SECOND LPAREN datestring_ RPAREN //todo: stricter TIME
systime_ ::= SYSTIME LPAREN RPAREN
time-from-date-time_ ::= TIME_FROM_DATE_TIME LPAREN datestring_ COMMA boolean_ RPAREN
time-zone_ ::= TIME_ZONE LPAREN RPAREN
tod_ ::= TOD LPAREN RPAREN
today_ ::= TODAY LPAREN RPAREN
year_ ::= YEAR LPAREN datestring_ RPAREN


// Environment function
activepid_ ::= ACTIVE_PID LPAREN number_ RPAREN
apiapplication-name_ ::= API_APPLICATION_NAME LPAREN RPAREN
batched_ ::= BATCHED LPAREN RPAREN
can-dee_ ::= CAN_DDE LPAREN RPAREN
check-auth_ ::= CHECK_AUTH LPAREN number_ RPAREN
colour-picker_ ::= COLOUR_PICKER LPAREN string_ RPAREN
create-db-schema_ ::= CREATE_DB_SCHEMA LPAREN string_ COMMA "SPACES" RPAREN
create-db-user_ ::= CREATE_DB_USER LPAREN string_ COMMA "SPACES" RPAREN
currency-sign_ ::= CURRENCY_SIGN LPAREN RPAREN
database-type_ ::= DATABASE_TYPE LPAREN RPAREN
db-command_ ::= DB_COMMAND LPAREN string_ RPAREN
db-table-name_ ::= DB_TABLE_NAME LPAREN string_ RPAREN
dde-error-status_ ::= DDE_ERROR_STATUS LPAREN RPAREN
dde-execute_ ::= DDE_EXECUTE LPAREN string_ COMMA string_ RPAREN
dde-initiate_ ::= DDE_INITIATE LPAREN string_ COMMA string_ RPAREN
dde-poke_ ::= DDE_POKE LPAREN string_ COMMA string_ COMMA string_ RPAREN
dde-request_ ::= DDE_REQUEST LPAREN string_ COMMA string_ RPAREN
dde-terminate_ ::= DDE_TERMINATE LPAREN string_ RPAREN
delete-registry-value_ ::= DELETE_REGISTRY_VALUE LPAREN string_ RPAREN
enable-status-bar_ ::= ENABLE_STATUS_BAR LPAREN boolean_ RPAREN
enable-system-menu_ ::= ENABLE_SYSTEM_MENU LPAREN boolean_ RPAREN
enable-tool-bar_ ::= ENABLE_TOOL_BAR LPAREN boolean_ RPAREN
error-description_ ::= ERROR_DESCRIPTION LPAREN number_ RPAREN
escape_ ::= ESCAPE LPAREN RPAREN
exit-status_ ::= EXIT_STATUS LPAREN RPAREN
find-parameter_ ::= FIND_PARAMETER LPAREN string_ RPAREN
getenv_ ::= GETENV LPAREN string_ RPAREN
get-field-value_ ::= GET_FIELD_VALUE LPAREN string_ RPAREN
get-field-value-numeric_ ::= GET_FIELD_VALUE_NUMERIC LPAREN string_ RPAREN
get-function-code_ ::= GET_FUNCTION_CODE LPAREN string_ RPAREN
get-module-code_ ::= GET_MODULE_CODE LPAREN string_ RPAREN
get-param_ ::= GET_PARAM LPAREN number_ RPAREN
get-registry-enum-key_ ::= GET_REGISTRY_ENUM_KEY LPAREN string_ COMMA number_ RPAREN
get-registry-enum-value_ ::= GET_REGISTRY_ENUM_VALUE LPAREN string_ COMMA number_ COMMA string_ RPAREN
get-registry-value_ ::= GET_REGISTRY_VALUE LPAREN string_ RPAREN
get-system-metrics_ ::= GET_SYSTEM_METRICS LPAREN number_ RPAREN
gid_ ::= GID LPAREN RPAREN
grant-db-schema_ ::= GRANT_DB_SCHEMA LPAREN string_ COMMA string_ RPAREN
hide-dockable-windows_ ::= HIDE_DOCKABLE_WINDOWS LPAREN (dockableflags_)? RPAREN
dockableflags_ ::= "0"| "non-zero"
idx_ ::= IDX LPAREN string_ (COMMA string_)* RPAREN
if-then-else_ ::= IF_THEN_ELSE LPAREN condition_ COMMA string_ COMMA string_ RPAREN //todo: condition
io-count_ ::= IO_COUNT LPAREN RPAREN
line-no_ ::= LINE_NO LPAREN RPAREN
local-no_ ::= LOCAL_NO_AND_LOCAL_YES LPAREN RPAREN
login-id_ ::= LOGIN_ID LPAREN RPAREN
mail-add-line_ ::= MAIL_ADD_LINE LPAREN string_ RPAREN
mail-attach_ ::= MAIL_ATTACH LPAREN string_ COMMA string_ COMMA number_ COMMA number_ COMMA number_ RPAREN
mail-cancel_ ::= MAIL_CANCEL LPAREN RPAREN
mail-from-name_ ::= MAIL_FROM_NAME LPAREN string_ RPAREN
mail-reply-to_ ::= MAIL_REPLY_TO LPAREN string_ COMMA string_ RPAREN
mail-send_ ::= MAIL_SEND LPAREN string_ COMMA boolean_ COMMA boolean_ RPAREN
mail-start_ ::= MAIL_START LPAREN string_ RPAREN
max-screen-columns_ ::= MAX_SCREEN_COLUMNS LPAREN RPAREN
max-screen-rows_ ::= MAX_SCREEN_ROWS LPAREN RPAREN
message-status_ ::= MESSAGE_STATUS LPAREN RPAREN
mode-name_ ::= MODE_NAME LPAREN RPAREN
mouse-column_ ::= MOUSE_COLUMN LPAREN RPAREN
mouse-row_ ::= MOUSE_ROW LPAREN RPAREN
node-name_ ::= NODE_NAME LPAREN RPAREN
occurrence_ ::= OCCURRENCE LPAREN string_ RPAREN
operating-system_ ::= OPERATING_SYSTEM LPAREN RPAREN
page-no_ ::= PAGE_NO LPAREN string_ RPAREN
param-cnt_ ::= PARAM_CNT LPAREN RPAREN
pid_ ::= PID LPAREN RPAREN
pronto-release_ ::= PRONTO_RELEASE LPAREN RPAREN
prouser-flags_ ::= PROUSER_FLAGS LPAREN RPAREN
refresh-quick-links_ ::= REFRESH_QUICK_LINKS LPAREN RPAREN
report-is-xml_ ::= REPORT_IS_XML LPAREN string_ RPAREN
review-row_ ::= REVIEW_ROW LPAREN RPAREN
revoke-db-schema_ ::= REVOKE_DB_SCHEMA LPAREN string_ COMMA string_ RPAREN
rgb-to-colour_ ::= RGB_TO_COLOUR LPAREN number_ RPAREN
screen-mode_ ::= SCREEN_MODE LPAREN RPAREN
search_ ::= SEARCH LPAREN RPAREN
search-mode_ ::= SEARCH_MODE LPAREN RPAREN
set-app-user_ ::= SET_APP_USER LPAREN string_ RPAREN
set-data-area-name_ ::= SET_DATA_AREA_NAME LPAREN string_ RPAREN
set-background-image_ ::= SET_BACKGROUND_IMAGE LPAREN string_ RPAREN
set-background-url_ ::= SET_BACKGROUND_URL LPAREN string_ COMMA background-urlflags_ RPAREN
background-urlflags_ ::= "1" | "2" | "4" | "8" //todo:  flag settings can be combined by adding the values together.
set-environment_ ::= SET_ENVIRONMENT LPAREN string_ COMMA string_ RPAREN
set-function-code_ ::= SET_FUNCTION_CODE LPAREN string_ RPAREN
set-help-context_ ::= SET_HELP_CONTEXT LPAREN string_ COMMA number_ RPAREN
set-keyboard-focus_ ::= SET_KEYBOARD_FOCUS LPAREN string_ COMMA string_ RPAREN //todo: 2nd string is flag not sure what the values are
set-module-code_ ::= SET_MODULE_CODE LPAREN string_ RPAREN
set-registry-value_ ::= SET_REGISTRY_VALUE LPAREN string_ COMMA string_ RPAREN
set-web-window_ ::= SET_WEB_WINDOW LPAREN string_ COMMA string_ COMMA string_ COMMA webwindowflag_ RPAREN
webwindowflag_ ::= "1" | "2" | "3" | "4" | "8" | "16" | "32" | "64" //todo:  flag settings can be combined by adding the values together.
sleep_ ::= SLEEP LPAREN number_ RPAREN
spool-file-name_ ::= SPOOL_FILE_NAME LPAREN (string_)? RPAREN
time-elapsed_ ::= TIME_ELAPSED LPAREN number_ COMMA number_ RPAREN
transaction-active_ ::= TRANSACTION_ACTIVE LPAREN RPAREN
tty_ ::= TTY LPAREN RPAREN
uid_ ::= UID LPAREN RPAREN
user-group_ ::= USER_GROUP LPAREN RPAREN
valid-activation-key_ ::= VALID_ACTIVATION_KEY LPAREN string_ COMMA string_ RPAREN
wait-for-input_ ::= WAIT_FOR_INPUT LPAREN RPAREN

//File handling functions
//FILEHANDLING_FUNCTIONS=(cd|cd-without-close-all|client-file-browse|dir|file-exists|file-name|file-owner|file-size|file-status|file-version|finish-dir-search|is-a-dir|local-cd|local-cd-without-close-all|local-dir|mkdir|modification-time|next-dir-entry|rmdir|start-dir-search)
cd_ ::= CD LPAREN string_ RPAREN
cd-without-close-all_ ::= CD_WITHOUT_CLOSE_ALL LPAREN string_ RPAREN
client-file-browse_ ::= CLIENT_FILE_BROWSE LPAREN string_ COMMA string_ COMMA browsefilters_* COMMA string_ COMMA browseflag_ RPAREN
browsefilters_ ::= "|" | "." | "*" | ";" | string_
browseflag_ ::= "1" | "2" | "4"
dir_ ::= DIR LPAREN RPAREN
file-exists_ ::= FILE_EXISTS LPAREN string_ COMMA number_ RPAREN
file-name_ ::= FILE_NAME LPAREN string_ RPAREN
file-owner_ ::= FILE_OWNER LPAREN string_ RPAREN
file-size_ ::= FILE_SIZE LPAREN string_ RPAREN
file-status_ ::= FILE_STATUS LPAREN RPAREN
file-version_ ::= FILE_VERSION LPAREN string_ RPAREN
finish-dir-search_ ::= FINISH_DIR_SEARCH LPAREN RPAREN
is-a-dir_ ::= IS_A_DIR LPAREN string_ RPAREN
local-cd_ ::= LOCAL_CD LPAREN RPAREN
local-cd-without-close-all_ ::= LOCAL_CD_WITHOUT_CLOSE_ALL LPAREN RPAREN
local-dir_ ::= LOCAL_DIR LPAREN RPAREN
mkdir_ ::= MKDIR LPAREN string_ RPAREN
modification-time_ ::= MODIFICATION_TIME LPAREN string_ RPAREN
next-dir-entry_ ::= NEXT_DIR_ENTRY LPAREN RPAREN
rmdir_ ::= RMDIR LPAREN string_ RPAREN
start-dir-search_ ::= START_DIR_SEARCH LPAREN (string_ COMMA string_)? RPAREN


//String functions
ascii-char_ ::= ASCII_CHAR LPAREN number_ RPAREN
ascii-num_ ::= ASCII_NUM LPAREN string_ RPAREN
base64toblob_ ::= BASE64TOBLOB LPAREN string_ COMMA string_ RPAREN
blobappend_ ::= BLOBAPPEND LPAREN string_ COMMA string_ RPAREN
blobappendbase64_ ::= BLOBAPPENDBASE64 LPAREN string_ COMMA string_ RPAREN
blobsection_ ::= BLOBSECTION LPAREN string_ COMMA string_ COMMA string_ COMMA string_ RPAREN
blobtobase64_ ::= BLOBTOBASE64 LPAREN string_ COMMA string_ COMMA string_ RPAREN
concat_ ::= CONCAT LPAREN string_ (COMMA? string_)* RPAREN
formatpicture_ ::= FORMATPICTURE LPAREN string_ COMMA picture_ RPAREN
freeblob_ ::= FREEBLOB LPAREN string_ RPAREN
fstr_ ::= FSTR LPAREN number_ COMMA number_ COMMA number_ RPAREN
leftjustify_ ::= LEFTJUSTIFY LPAREN string_ RPAREN
lowercase_ ::= LOWERCASE LPAREN string_ RPAREN
ltrim_ ::= LTRIM LPAREN string_ RPAREN
maxalphavalue_ ::= MAXALPHAVALUE LPAREN number_ RPAREN
num_ ::= NUM LPAREN string_ RPAREN
paramtext_ ::= PARAMTEXT LPAREN STRING (COMMA param_list_)? RPAREN
param_list_ ::= string_ (COMMA string_)*
pattern_ ::= PATTERN LPAREN string_ COMMA string_  RPAREN
readblobfromfile_ ::= READBLOBFROMFILE LPAREN string_ COMMA string_ RPAREN
reserved_ ::= RESERVED LPAREN string_ RPAREN
rightjustify_ ::= RIGHTJUSTIFY LPAREN string_ RPAREN
rtrim_ ::= RTRIM LPAREN string_ RPAREN
sizeof_ ::= SIZEOF LPAREN string_ RPAREN
sqlsubstring_ ::= SQLSUBSTRING LPAREN string_ COMMA number_ COMMA number_ RPAREN
strconcat_ ::= STRCONCAT LPAREN string_ (COMMA? string_)* RPAREN
str_ ::= STR_FUNC LPAREN number_ RPAREN
strlen_ ::= STRLEN LPAREN string_ RPAREN
substring_ ::= SUBSTRING LPAREN string_ COMMA number_ COMMA number_ RPAREN
substringutf8_ ::= SUBSTRINGUTF8 LPAREN string_ COMMA number_ COMMA number_ COMMA number_ RPAREN
uppercase_ ::= UPPERCASE LPAREN string_ RPAREN
validnumber_ ::= VALIDNUMBER LPAREN string_ RPAREN
writeblobtofile_ ::= WRITEBLOBTOFILE LPAREN string_ COMMA string_ RPAREN
zstr_ ::= ZSTR LPAREN number_ COMMA number_ COMMA number_ RPAREN


// Preprocessor rule
preprocessors_ ::= PREPROCESSOR (IDENTIFIER | STRING)


// Screen rule
screen_ ::= SCREEN IDENTIFIER (SCREEN_RESPONSIVE)? (window_)? (windowpositision_)? (screentitle_)? (screenprimary_)? (screenselect_)? (screenquicklink_)? (colour_)? (screenreview_)? (screenallowed_)? (SCREEN_PROMPT_FOR_SEARCH)? (SCREEN_FIND_FOR_CURRENCY)? (screenprompt_)? (screendatagrid_)? (screenreviewoccurs)? (SCREEN_REVIEW_FROM_START)? (SCREEN_NO_REVIEW_ROW_SEPARATORS)? (SCREEN_NO_REVIEW_COLUMN_SEPARATORS)? (SCREEN_NO_REVIEW_SEPARATORS)? (SCREEN_START_ON_CURRENT_RECORD)? (SCREEN_LEAVE_PARENT_SCREEN)? (screenwhen_)? (local_)? (parameters_)? (returning_)? (STOP_EXIT_ALL_KEY)? (SCREEN_POSITION_ON_OK)? (SCREEN_STAY_IN_CORRECT)? (SCREEN_FORM_ENTRY)? (export_)? (screenhelpcontext_)? (before_)? (detail_)? (after_)? SCREEN_END

screentitle_ ::= TITLE ("is")? string_
screenprimary_ ::= SCREEN_PRIMARY IDENTIFIER (ON INDEX)? (SCREEN_SAME_DIFFERENT (IDENTIFIER fieldclauses_)*)?
screenselect_ ::= SELECT selectclauses_
screenquicklink_ ::= SCREEN_QUICK_LINK (ON)? IDENTIFIER
screenreview_ ::= SCREEN_REVIEW ("is")? "colour" (ON)? IDENTIFIER
screenallowed_ ::= SCREEN_ALLOWED ("is"|"are")? ("FIND"|"NEXT"|"PREV"|"NEXT-SCR"|"PREV-SCR"|"SEARCH"|"ENTRY"|"CORRECT"|"REMOVE"|"find"|"next"|"prev"|"next-scr"|"prev-scr"|"search"|"entry"|"correct"|"remove") IDENTIFIER* //todo: [mode-name ...]]
screenprompt_ ::= PROMPT rowcol_
screendatagrid_ ::= SCREEN_DATA_GRID
screenreviewoccurs ::= SCREEN_REVIEW_OCCURS number_ ("by" number_)?
screenwhen_ ::= WHEN condition_ //todo: conditon

// API rule
api_ ::= API IDENTIFIER procedureclauses_ API_END 

// Field rule
field_ ::= FIELD (IDENTIFIER fieldclauses_)*
fieldclauses_ ::= (fieldtype_)? (fieldpic_)? (fieldoccurs_)? (fieldlike_)? (fieldcase_)? (JUSTIFY)? (USE_NAME_IN_DB)? (fielddbcolumnname_)? (fielddrillback_)?
fieldtype_ ::= TYPE ("is")? datatypes_
datatypes_ ::= ("NUMERIC"|"DECIMAL"|"MONEY"|"FLOATING"|"ALPHA"|"STRING"|"VARCHAR"|"BLOB"|"XML-HANDLE"|"DATE"|"TIME"|"DATE-TIME"|"DATETIME"|"DATE_TIME"|"LOCAL-DATE-TIME"|"BOOLEAN"|"COLOUR"|"COLOR"|"OLE-INTERFACE"|"numeric"|"decimal"|"money"|"floating"|"alpha"|"string"|"varchar"|"blob"|"xml-handle"|"date"|"time"|"date-time"|"datetime"|"date_time"|"local-date-time"|"boolean"|"colour"|"color"|"ole-interface")
fieldpic_ ::= PIC ("is")? picture_
fieldoccurs_ ::= OCCURS NUMBER ("times")?
fieldlike_ ::= LIKE IDENTIFIER
fieldcase_ ::= ("UPPERCASE" | "LOWERCASE" | "uppercase" | "lowercase")
fielddbcolumnname_ ::= DB_COLUMN_NAME ("is")? string_
fielddrillback_ ::= DRILL_BACK ("is")? string_

// Local field rule
local_ ::= LOCAL (FIELD)? (IDENTIFIER fieldclauses_)*

// Menu rule
menu_ ::= MENU IDENTIFIER menucaluses_ MENU_END
menucaluses_ ::= (window_)? (windowpositision_)? (local_)? (parameters_)? (returning_)? (menubuttonwidth_)? (STOP_EXIT_ALL_KEY)? (TITLE ("is")? string_)? (TREEMENU)? (NOHIDE)? (colour_)? (export_)? (helpcontext_)? (before_)? (detail_)? (after_)?
menubuttonwidth_ ::= MENU_BUTTON_WIDTH ("is")? number_

// Mode rule
mode_ ::= MODE IDENTIFIER modeclauses_
modeclauses_ ::= (prompt_)? (help_)? (security_)? (modeentry_)? (process_)? (modecurrency_)? (LOCK)? (modeperform_)? (modewhen_)? (colour_)? (modeicon_)? (alwaysshowaddnohide_)?
prompt_ ::= PROMPT ("is")? string_
help_ ::= HELP ("is")? string_
security_ ::= SECURITY ("is")? number_
modeentry_ ::= MODEENTRY
process_ ::= PROCESS
modecurrency_ ::= MODECURRENCY
modeperform_ ::= PERFORM IDENTIFIER
modewhen_ ::= WHEN condition_
modeicon_ ::= ICON ("is")? modeiconlist_
modeiconlist_ ::= "FOLDER-ICON"
                | "ADMIN-FOLDER-ICON"
                | "REPORT-FOLDER-ICON"
                | "ADMIN-ICON"
                | "REPORT-ICON"
                | "SCREEN-ICON"
                | "TRANSACTION-ICON"
                | "PERIOD-END-ICON"
                | "QUESTION-ICON"
                | "BLANK-ICON"
                | "FAVOURITES-FOLDER-ICON"
                | "LOCKED-FOLDER-ICON"
                | "BLUE-FOLDER-ICON"
                | "RED-FOLDER-ICON"
                | "GREEN-FOLDER-ICON"
                | "ENQUIRY-FOLDER-ICON"
alwaysshowaddnohide_ ::= (ALWAYS_SHOW)? (ALWAYS_ADD)? (NOHIDE)?


// Object rule
object_ ::= OBJECT (IDENTIFIER objectclauses_)*
objectclauses_ ::= (objectlike_)? (objecttype_)? (objectseparator_)? (objectfile_)? (objectrecord_)? (objectkey_)? (NOJOINS)? (NOROWID)?
objectlike_ ::= LIKE IDENTIFIER
objecttype_ ::= TYPE ("is")? filetypes_
filetypes_ ::= ("EXTERNAL"|"TEXT"|"SEQUENTIAL"|"FIXED-LENGTH-TEXT"|"INDEXED"|"ISAM"|"PRN"|"CSV"|"DB-SEQUENTIAL"|"MEMORY"|"external"|"text"|"sequential"|"fixed-length-text"|"indexed"|"isam"|"prn"|"csv"|"db-sequential"|"memory")
objectseparator_ ::= SEPARATOR ("is")? string_
objectfile_ ::= FILE ("is")? string_
objectrecord_ ::= RECORD ("is")? (IDENTIFIER fieldclauses_)* RECORD_END
objectkey_ ::= KEY ("is")? (IDENTIFIER (DESC)? (UNIQUE)? (DB_INDEX_ONLY)? (COMPRESS)?)*

// Parameters rule
parameters_ ::= PARAMETERS ("are"|"is")? (IDENTIFIER fieldclauses_)*

// Returning rule
returning_ ::= RETURNING (IDENTIFIER fieldclauses_)*

// Procedure rule
procedure_ ::= PROCEDURE IDENTIFIER procedureclauses_ PROCEDURE_END
procedureclauses_ ::= (window_)? (relative_)? (NOHIDE)? (windowpositision_)? (colour_)? (local_)? (parameters_)? (returning_)? (STOP_EXIT_ALL_KEY)? (TITLE string_)? (export_)? (AUTO_TRANSACTION)? (helpcontext_)? statement_*

// Other rules
export_ ::= EXPORT (CAN_OVERRIDE)?
colour_ ::= COLOUR ("is")? IDENTIFIER (ON IDENTIFIER)?
helpcontext_ ::= SCREEN_HELP_CONTEXT ("is") string_ string_
window_ ::= WINDOW rowcol_ "to" rowcol_ (relative_)?
relative_ ::= RELATIVE_TO "to" rowcol_
windowpositision_ ::= WINDOW_POSITION ("is")? number_
before_ ::= BEFORE statement_*
detail_ ::= DETAIL statement_*
after_ ::= AFTER statement_* 


//row and col
//Syntax @row,col
rowcol_ ::= AT NUMBER COMMA NUMBER
expression_ ::= item_* //todo: expression
condition_ ::= item_* //todo: condition, Need to double check the differnce between expression and condition
string_ ::= STRING | IDENTIFIER | BAD_CHARACTER | datetimefunction_ | environmentfunction_  | filehandlingfunction_ | stringfunction_
number_ ::= NUMBER | IDENTIFIER | arithmeticfunction_ | datetimefunction_ | environmentfunction_ | filehandlingfunction_
boolean_ ::= "TRUE" | "FALSE" | "true" | "false" | "1" | "0"
datestring_ ::= DATE | TIME | IDENTIFIER | datetimefunction_ | modification-time_
//The following picture string characters are used to specify the format of a field being defined.
// They indicate the size of the field, number of integer/decimal places and whether the field allows negative amounts.
// todo: add more picture string characters, this covers the basics.
picture_ ::= pic_group_ | pic_words
pic_words ::= "ddmmmyybhh:mm"| "HH:MM:SS" // Date and time format
pic_group_ ::= (NUMBER | IDENTIFIER) (LPAREN number_ RPAREN)? (IDENTIFIER LPAREN number_ RPAREN)?
comments_ ::= COMMENT | BLOCK_COMMENT

element_ ::= FUNCTION_DECLARATION
           | KEYWORD
           | STRING
           | NUMBER
           | IDENTIFIER
           | comments_
           | TITLE
           | DEFAULT
           | WINDOW
           | PROMPT
           | DETAIL
           | ICON
           | TAG
           | HELP_CONTEXT
           | OPTIONAL
           | BELL
           | NOBELL
           | COLOUR
           | TYPE
           | PIC
           | OCCURS
           | LIKE
           | JUSTIFY
           | USE_NAME_IN_DB
           | DB_COLUMN_NAME
           | DRILL_BACK
           | RELATIVE_TO
           | WINDOW_POSITION
           | PARAMETERS
           | RETURNING
           | STOP_EXIT_ALL_KEY
           | EXPORT
           | CAN_OVERRIDE
           | BEFORE
           | AFTER
           | SEPARATOR
           | FILE
           | RECORD
           | RECORD_END
           | KEY
           | DESC
           | UNIQUE
           | DB_INDEX_ONLY
           | COMPRESS
           | NOJOINS
           | NOROWID
           | COLUMNTITLE
           | NOLOG
           | NOTITLE
           | MULTILINE
           | ROWS
           | COLUMNS
           | BLANK_WHEN_ZERO
           | BLANK_DECIMALS_WHEN_ZERO
           | ALLOW
           | DISALLOW
           | AUTO_RETURN
           | TIMEOUT
           | EDIT
           | FILL
           | LOOKUP
           | LEFT
           | CENTRE
           | RIGHT
           | CENTRE_COORD
           | RIGHT_COORD
           | BOLD
           | DIM
           | FLASHING
           | INVERSE
           | ITALIC
           | UNDERLINED
           | FOREGROUND
           | BACKGROUND
           | BLANK
           | ERROR
           | END_ON
           | FUNCTION_KEY
           | HELP_SCREEN
           | SHOWING
           | USING
           | SHOW_VALUE
           | NO_CLEAR
           | SUPPRESS
           | CONDITIONAL_SUPPRESS
           | READ_ONLY
           | FIXED_WIDTH_FONT
           | BEFORE_ACCEPT
           | END_BEFORE_ACCEPT
           | VALIDATIONS
           | END_VALIDATIONS
           | USE_VALIDATE_TRIGGER
           | SCALE
           | NO_WARNING
           | CHANGE
           | LEAVING
           | FREE_LOCKS
           | DOUBLE
           | NO_CROSS
           | SUNKEN
           | ABSOLUTE_COORDINATES
           | MAX_PARAMETERS
           | HOME
           | BATCH
           | LEAVE_FILES_OPEN
           | EXTERNAL
           | BACKGROUNDNOWAITWAIT
           | HTTP_HEADERS
           | HTTP_BODY
           | HTTP_METHOD
           | HTTP_PROXY
           | HTTP_AUTH_ANY
           | CA_CERTIFICATE
           | SSL_CERTIFICATE
           | SSL_KEY
           | SSL_KEY_PASSWORD
           | ALLOW_REDIRECTION
           | SFTP_COMMAND
           | SFTP_POST_COMMAND
           | SFTP_CREATE_DIRS
           | URL_USER
           | URL_LOGIN_OPTIONS
           | VALUES
           | RIGHT_COORDINATE
           | BEFORE_CHECK_BOX
           | END_BEFORE_CHECK_BOX
           | MESSAGEBOX_BUTTONS
           | DATA
           | NO_MESSAGE
           | NO_REFRESH
           | NO_XTERM
           | AUTO
           | NO_PROMPT
           | NO_WINDOW
           | CONFIRMED
           | NOT_CONFIRMED
           | COL
           | BITMAP
           | HELP_IS
           | SAME
           | ONCE
           | SUB_SCREEN
           | INITIAL_MODE
           | NEXT
           | NO_SECTION
           | DYNAMIC
           | CONCAT_TITLE
           | WIDTH
           | PREVIOUS
           | FINISH
           | ALL
           | WHERE
           | WRAP
           | VERTICAL
           | DOWN
           | STEP
           | SCREEN_RESPONSIVE
           | SCREEN_PRIMARY
           | INDEX
           | SCREEN_SAME_DIFFERENT
           | SCREEN_QUICK_LINK
           | SCREEN_REVIEW
           | SCREEN_ALLOWED
           | SCREEN_PROMPT_FOR_SEARCH
           | SCREEN_FIND_FOR_CURRENCY
           | SCREEN_DATA_GRID
           | SCREEN_REVIEW_OCCURS
           | SCREEN_REVIEW_FROM_START
           | SCREEN_NO_REVIEW_ROW_SEPARATORS
           | SCREEN_NO_REVIEW_COLUMN_SEPARATORS
           | SCREEN_NO_REVIEW_SEPARATORS
           | SCREEN_START_ON_CURRENT_RECORD
           | SCREEN_LEAVE_PARENT_SCREEN
           | WHEN
           | SCREEN_POSITION_ON_OK
           | SCREEN_STAY_IN_CORRECT
           | SCREEN_FORM_ENTRY
           | AUTO_TRANSACTION
           | TREEMENU
           | NOHIDE
           | MENU_BUTTON_WIDTH
           | HELP
           | SECURITY
           | PROCESS
           | MODECURRENCY
           | LOCK
           | PERFORM
           | ALWAYS_SHOW
           | ALWAYS_ADD
           | FROM
           | FIRST
           | LAST
           | CURRENT
           | THEN
           | ELSE
           | ELSEIF
           | NO_MAIN
           | WAIT_WITH_TIMEOUT
           | CREATE
           | TRUNCATE
           | PERMANENTTEMPORARY
           | PRIVATE
           | NO_TRIGGERS
           | INDEX_ON_CLOSE
           | LOG
           | BITMAP_PUSHED
           | BITMAP_FOCUS
           | BITMAP_HOVER
           | BITMAP_GREYED
           | NO_ASPECT_RATIO
           | BUTTON_STYLE
           | DEFAULT_BUTTON
           | TEXT_POSITION
           | HOTKEY
           | HIDDEN
           | NO_THEME
           | NO_HEADER
           | NO_FOOTER
           | ON
           | COLUMN
           | SUBSCRIPT
           | SUPERSCRIPT
           | FONT
           | SECTION
           | NO_NEWLINE
           | NO_PAUSE
           | SPOOL
           | BUTTON_WHEN
           | BEFORE_RADIO_BUTTON
           | END_BEFORE_RADIO_BUTTON
           | WHENS
           | PROMPTS
           | REVIEW
           | UNTIL
           | DIRECT
           | NAME
           | HEADER
           | FOOTER
           | DEPTH
           | LENGTH
           | MARGIN
           | FULL_PAGE
           | FORM
           | NO_XML
           | SPOOL_ONLY
           | FULL_XML
           | CAN_HIDE
           | STYLE_CLASS
           | ROW
           | GROUP_STYLE
           | SECTION_WHEN
           | HIDE
           | DISTINCT
           | DATABASE_SQL
           | LOCAL_SQL
           | ORDER
           | GROUP
           | FOR_UPDATE
           | HAVING
           | INSERTING
           | REPLACING
           | DELETING
           | APPENDING
           | CASE
           | BEGIN
           | COMMIT
           | ROLLBACK
           | MESSAGEBOX_BUTTONS_VALUES
           | MESSAGEBOX_ICON_VALUES
           | MODEENTRY
           | othersymbols_

othersymbols_ ::= SYMBOLS | SEMICOLON | DOT | EQUALS | LBRACE | RBRACE | LPAREN | RPAREN | COMMA | AT